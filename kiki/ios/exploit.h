#ifndef EXPLOIT_H
#define EXPLOIT_H

#include <IOKit/IOKitLib.h>
#include <stdint.h>

uint32_t get_kernel_region(io_connect_t connect);
uint32_t get_kernel_text_start();

void call_direct(io_connect_t connect, uint32_t fn, uint32_t arg1, uint32_t arg2);
void call_indirect(io_connect_t connect, uint32_t fn, uint32_t arg1_address, uint32_t arg2);

uint8_t* kernel_read_exception_vector(io_connect_t connect, uint32_t start, uint32_t size);
uint8_t* kernel_read_exception_vector2(io_connect_t connect, uint32_t start, uint32_t size, uint32_t* crash_pc);

int kernel_read(io_connect_t connect, uint32_t memmove, uint32_t address, void* buffer, uint32_t size);

#endif
